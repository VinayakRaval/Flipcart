<!doctype html>
<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Reset Password</title><link rel="stylesheet" href="css/style.css"></head>
<body>
<section style="max-width:500px;margin:80px auto;">
  <div style="background:#fff;padding:20px;border-radius:8px;box-shadow:0 8px 20px rgba(0,0,0,0.06);">
    <h3>Reset Password</h3>
    <p>Enter your email and new password.</p>
    <input id="email" class="input" placeholder="Your email" />
    <input id="newPass" class="input" placeholder="New password" type="password" />
    <input id="confirmPass" class="input" placeholder="Confirm password" type="password" />
    <button id="resetBtn" class="save-btn" style="margin-top:8px;">Reset Password</button>
    <p id="msg" style="font-weight:600;margin-top:8px;"></p>
  </div>
</section>
<script>
document.getElementById('resetBtn').addEventListener('click', async ()=>{
  const email = document.getElementById('email').value.trim();
  const np = document.getElementById('newPass').value;
  const cp = document.getElementById('confirmPass').value;
  const msg = document.getElementById('msg');
  if(!email || !np) { msg.style.color='red'; msg.textContent='Provide email and new password'; return; }
  if(np !== cp){ msg.style.color='red'; msg.textContent='Passwords do not match'; return; }
  try{
    const res = await fetch('/flipcart/backend/auth/reset_password.php', {
      method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ email, new_password: np })
    });
    const d = await res.json();
    if(res.ok){ msg.style.color='green'; msg.textContent = d.message || 'Password reset'; setTimeout(()=>window.location.href='login.html',1200); }
    else { msg.style.color='red'; msg.textContent = d.error || 'Failed'; }
  }catch(e){ msg.style.color='red'; msg.textContent='Network error'; }
});
</script>
</body></html>
